<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Carcassonne</title>
    <style>
        body { 
            margin: 0; 
            padding: 20px; 
            background: #1a1a1a; 
            color: white; 
            font-family: Arial, sans-serif;
            text-align: center;
        }
        #game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }
        canvas { 
            border: 2px solid #444;
            background: #000;
        }
        #status { 
            font-size: 18px;
            padding: 10px;
        }
        .loading { color: #4CAF50; }
        .error { color: #f44336; }
    </style>
</head>
<body>
    <div id="game-container">
        <h1>üè∞ Carcassonne</h1>
        <div id="status" class="loading">Initializing...</div>
        <canvas id="canvas" width="1280" height="720"></canvas>
    </div>

    <script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>
    <script>
        let pyodide;
        
        async function main() {
            const status = document.getElementById('status');
            const canvas = document.getElementById('canvas');
            
            try {
                status.textContent = "Loading Python environment...";
                pyodide = await loadPyodide();
                
                status.textContent = "Installing pygame...";
                await pyodide.loadPackage("pygame");
                
                status.textContent = "Setting up canvas...";
                
                // Nastavte pygame canvas
                pyodide.runPython(`
                    import pygame
                    import asyncio
                    import sys
                    
                    # Initialize pygame
                    pygame.init()
                    screen = pygame.display.set_mode((1280, 720))
                    pygame.display.set_caption("Carcassonne")
                    
                    clock = pygame.time.Clock()
                    font = pygame.font.Font(None, 74)
                    
                    async def game_loop():
                        running = True
                        while running:
                            for event in pygame.event.get():
                                if event.type == pygame.QUIT:
                                    running = False
                            
                            # Clear screen
                            screen.fill((50, 50, 70))
                            
                            # Draw test content
                            text = font.render("Carcassonne Web Version", True, (255, 255, 255))
                            text_rect = text.get_rect(center=(640, 200))
                            screen.blit(text, text_rect)
                            
                            instructions = pygame.font.Font(None, 36).render("Click to start your game!", True, (200, 200, 200))
                            inst_rect = instructions.get_rect(center=(640, 300))
                            screen.blit(instructions, inst_rect)
                            
                            pygame.display.flip()
                            clock.tick(60)
                            
                            # Critical for web
                            await asyncio.sleep(0)
                    
                    # Start the game
                    asyncio.create_task(game_loop())
                `);
                
                status.textContent = "Game ready! üéÆ";
                status.className = "";
                
            } catch (error) {
                status.textContent = `Error: ${error.message}`;
                status.className = "error";
                console.error(error);
            }
        }
        
        // Start when page loads
        main();
    </script>
</body>
</html>